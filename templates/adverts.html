{% extends "layout.html" %}
{% block title %}
List adverts
{% endblock %}
{% block content %}

<h2>List of {{count}} adverts for {{country}}</h2>

  <form id="formdomain", class="dropdown" action="/getadverts/{{country}}"  method="GET">
    <p>Filter by Domain</p>
    <select id="domainname" name="domainname">
      <option value="Default">All</option>
      {%for domain in domains%}
      <option value="{{domain}}">{{domain}}</option>
      {%endfor%}
      
    
    </select>
    
    
    <button class="btndomain" id="btndomain" type="submit" form="formdomain" value="Submit">Submit</button>
    
  </form> 
  <script> 
    if (sessionStorage.getItem("selectedOption")) {
      document.getElementById("domainname").value = sessionStorage.getItem("selectedOption");
    }
    
    document.getElementById("formdomain").addEventListener("submit", () => {
      var selectedOption = document.getElementById("domainname").value;
      sessionStorage.setItem("selectedOption", selectedOption);
    });
  </script>



  {% for advert in adverts%}
  <form  name='adverts_form{{advert.advert_id}}' class="listadverts" id="form{{advert.advert_id}}" action="/getadverts/{{country}}" onsubmit="return ValidateForm({{advert.advert_id}})" method="post">
    
    
        <input id="advert_id" name="advert_id" type="hidden" value={{advert.advert_id}}>
        <input id="hiddenDomain" name="hiddenDomain" type="hidden" value="">

        <script>
          var hiddendomainvar=sessionStorage.getItem("selectedOption");
          document.getElementById("hiddenDomain").value=hiddendomainvar;
        </script>

        <div class=seller_details>
          <p>{{advert.domain}}</p>
          <p>Seller: {{advert.seller}}</p>  
          <p>Price: {{advert.price}}</p>
          
        </div>
        

      
      
        <a href={{advert.url}} , target="_blank">{{advert.product}}</a>
        

      
      

        <select id="category" name="category">
          <option value="{{advert.category}}">{{advert.category}}</option>
          <option value="suspected counterfeiter">Suspected Counterfeiter</option>
          <option value="takedown">Takedown</option>
          <option value="no action">No action - this advert</option>
          <option value="no action all">No action - all sellers adverts</option>
          <option value="syngenta authorised">syngenta authorised</option>
          <option value="not relevant">Not Relevant</option>
          

        </select>
      

        <select id="business" name="business">
          <option value="{{advert.business}}">{{advert.business}}</option>
          <option value="Crop Protection">Crop Protection</option>
          <option value="Seeds">Seeds</option>
          <option value="Professional Solutions">Professional Solutions</option>
        </select>
      
        <textarea id="comments" name="comments" style="height: 50px; width: 200px" style="font-family:sans-serif;font-size:1.2em;" placeholder="(optional) Notes"></textarea>

        <button id="btn{{advert.advert_id}}" type="submit" form="form{{advert.advert_id}}" value="Submit">Submit</button>

  </form>


  {% endfor %}


{% endblock %}
